---
const pathname = Astro.url?.pathname ?? "/";
const isTR = pathname.startsWith("/tr");

// ---
// Sprachwechsel-URLs berechnen (Standard: gleicher Pfad mit/ohne /tr)
// ---
const dePath = isTR ? pathname.replace(/^\/tr(?=\/|$)/, "") || "/" : pathname;
const trPath = isTR ? pathname : `/tr${pathname === "/" ? "" : pathname}`;

let deHref = dePath;
let trHref = trPath;

// ---
// Sonderfall: Impressum/Datenschutz gibt es nur auf Deutsch.
// ---
const legalDE = new Set(["/impressum", "/datenschutz"]);
if (!isTR && legalDE.has(dePath)) {
  trHref = "/tr/";
}

const legalTR = new Set(["/tr/impressum", "/tr/datenschutz"]);
if (isTR && legalTR.has(pathname)) {
  deHref = pathname.replace(/^\/tr/, "") || "/";
  trHref = "/tr/";
}

// ---
// Navigation: Labels + Links (DE/TR Seiten)
// ---
const navItemsDE = [
  { href: "/", label: "Start" },
  { href: "/leistungen", label: "Leistungen" },
  { href: "/ueber-mich", label: "Ãœber mich" },
  { href: "/kontakt", label: "Kontakt" },
];

const navItemsTR = [
  { href: "/tr/", label: "Ana Sayfa" },
  { href: "/tr/leistungen", label: "Hizmetler" },
  { href: "/tr/ueber-mich", label: "HakkÄ±mda" },
  { href: "/tr/kontakt", label: "Ä°letiÅŸim" },
];

const navItems = isTR ? navItemsTR : navItemsDE;

// Brand-Link je nach Sprache
const brandHref = isTR ? "/tr/" : "/";

// Brand-Subtitle je nach Sprache (nur Text im Header)
const brandSubtitle = isTR
  ? "Almanca â†” TÃ¼rkÃ§e Dil AracÄ±lÄ±ÄŸÄ±"
  : "Sprachmittlung Deutsch â†” TÃ¼rkisch";
---

<header class="site-header">
  <div class="container header-inner">
    <a href={brandHref} class="brand" aria-label={isTR ? "Ana sayfa" : "Startseite"}>
      <img
        src="/logo.png"
        alt="Zehra Yacine â€“ Sprachmittlung Deutsch â†” TÃ¼rkisch"
        class="logo-image"
      />
      <span class="brand-title">
        Zehra Yacine
        <span class="brand-subtitle">{brandSubtitle}</span>
      </span>
    </a>

    {/* Desktop: Navigation + Sprache ganz rechts */}
    <div class="nav-right nav-right--desktop">
      <nav class="main-navigation" aria-label={isTR ? "Ana navigasyon" : "Hauptnavigation"}>
        <ul class="nav-links">
          {navItems.map((item) => (
            <li>
              <a href={item.href}>{item.label}</a>
            </li>
          ))}
        </ul>
      </nav>

      <div class="lang-links" aria-label={isTR ? "Dil seÃ§imi" : "Sprache wÃ¤hlen"}>
        <a
          class={`lang-link ${!isTR ? "is-active" : "is-inactive"}`}
          href={deHref}
          lang="de"
          hreflang="de"
          aria-current={!isTR ? "page" : undefined}
          aria-label="Deutsch"
        >
          <span aria-hidden="true">ðŸ‡©ðŸ‡ª</span> <span class="code">DE</span>
        </a>

        <span class="lang-sep" aria-hidden="true">|</span>

        <a
          class={`lang-link ${isTR ? "is-active" : "is-inactive"}`}
          href={trHref}
          lang="tr"
          hreflang="tr"
          aria-current={isTR ? "page" : undefined}
          aria-label="TÃ¼rkÃ§e"
        >
          <span aria-hidden="true">ðŸ‡¹ðŸ‡·</span> <span class="code">TR</span>
        </a>
      </div>
    </div>

    {/* Mobile: Sprache rechts, Burger ganz rechts (modern, ohne Rand) */}
    <div class="nav-right nav-right--mobile" aria-label={isTR ? "MenÃ¼ ve dil" : "MenÃ¼ und Sprache"}>
      <div class="lang-links" aria-label={isTR ? "Dil seÃ§imi" : "Sprache wÃ¤hlen"}>
        <a
          class={`lang-link ${!isTR ? "is-active" : "is-inactive"}`}
          href={deHref}
          lang="de"
          hreflang="de"
          aria-current={!isTR ? "page" : undefined}
          aria-label="Deutsch"
        >
          <span aria-hidden="true">ðŸ‡©ðŸ‡ª</span> <span class="code">DE</span>
        </a>

        <span class="lang-sep" aria-hidden="true">|</span>

        <a
          class={`lang-link ${isTR ? "is-active" : "is-inactive"}`}
          href={trHref}
          lang="tr"
          hreflang="tr"
          aria-current={isTR ? "page" : undefined}
          aria-label="TÃ¼rkÃ§e"
        >
          <span aria-hidden="true">ðŸ‡¹ðŸ‡·</span> <span class="code">TR</span>
        </a>
      </div>

      {/* Ohne JS: details/summary als Mobile-MenÃ¼ */}
      <details class="mobile-menu">
        <summary class="burger" aria-label={isTR ? "MenÃ¼yÃ¼ aÃ§/kapat" : "MenÃ¼ Ã¶ffnen/schlieÃŸen"}>
          <span class="burger-lines" aria-hidden="true"></span>
        </summary>

        <nav class="mobile-nav" aria-label={isTR ? "Mobil menÃ¼" : "Mobiles MenÃ¼"}>
          <ul class="mobile-links">
            {navItems.map((item) => (
              <li>
                <a href={item.href}>{item.label}</a>
              </li>
            ))}
          </ul>
        </nav>
      </details>
    </div>
  </div>
</header>